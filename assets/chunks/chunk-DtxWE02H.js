import{p as v,V as B,b as F,u as P}from"./chunk-CSFIeiLH.js";import{V as I}from"./chunk-D810R0as.js";import{e as D,g as $}from"./chunk-DyvYxXn8.js";import{d as E,aK as g,H as i,c,f as o,aL as R,aM as S,F as N,aN as f,W as w,l as n,o as V,e as b,w as s,al as h,P as z,Q as A,n as M,G}from"./chunk-C7hCAWl2.js";import{V as H}from"./chunk-vjpQnoJ0.js";import{_ as K}from"./chunk-BV6Aturx.js";import{_ as L}from"./chunk-CsCbVIPo.js";import{_ as Q}from"./chunk-BNL6fRHT.js";const W={...v,columns:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},readonly:{type:Boolean,default:void 0},splicable:{type:Boolean,default:!0},inheritTemplates:{type:Boolean,default:!1}},j={"update:modelValue":null},q=E({name:"VkfInputCollection",components:{ElTable:g,ElButton:i,VkTableColumns:I,VkfFormItem:B,VkfTemplateInstancesProvider:K,VkfTemplatesDefault:H,VkfRendererData:Q},props:W,emits:j,setup(e,{emit:l}){const _=F(e),r=P(e),m=c(()=>{if(!e.prop||e.prop.length===0)return e.modelValue;const a={};return D(a,{k:e.prop,v:e.modelValue}),a}),T=c(()=>e.columns.map(a=>({...a,slots:t=>o(L,{source:[{prop:[e.prop??[],t.$index,a.prop].flat(),templateType:a.templateType,readonly:r.value,...a.templateProps,...a.createTemplateProps?.(t)}]},null)}))),u=c(()=>({label:"操作",align:"center",width:"120px",hidden:r.value||!e.splicable,slots:({$index:a})=>o(N,null,[o(i,{size:"small",icon:R,onClick:()=>d(a)},null),o(i,{size:"small",icon:S,onClick:()=>p(a)},null)])}));function d(a){const t=f(e.modelValue);t.splice(a+1,0,{}),l("update:modelValue",t)}function p(a){const t=f(e.modelValue);t.splice(a,1),l("update:modelValue",t)}return{addToFirst:()=>{l("update:modelValue",[{},...e.modelValue])},formItemBindProps:_,readonly:r,fullColumns:T,buttonsColumn:u,handleFormSetData:a=>{const t=f(m.value);D(t,a),l("update:modelValue",$(t,e.prop))},formData:m}}}),J={key:0,class:"vkf-input-collection-options"};function O(e,l,_,r,m,T){const u=n("VkfTemplatesDefault"),d=n("ElButton"),p=n("VkTableColumns"),C=n("ElTable"),y=n("VkfFormItem"),a=n("VkfRendererData"),t=n("VkfTemplateInstancesProvider");return V(),b(t,{"inherit-templates":e.inheritTemplates},{default:s(()=>[e.inheritTemplates?h("",!0):(V(),b(u,{key:0})),o(a,{data:e.formData,onSetData:e.handleFormSetData},{default:s(()=>[o(y,z(A(e.formItemBindProps)),{default:s(()=>[!e.readonly&&e.splicable?(V(),M("div",J,[o(d,{type:"primary",onClick:e.addToFirst},{default:s(()=>l[0]||(l[0]=[G(" 添加 ")])),_:1},8,["onClick"])])):h("",!0),o(C,{data:e.modelValue,class:"vkf-input-collection-table"},{default:s(()=>[o(p,{source:[...e.fullColumns,e.buttonsColumn]},null,8,["source"])]),_:1},8,["data"])]),_:1},16)]),_:1},8,["data","onSetData"])]),_:1},8,["inherit-templates"])}const k=w(q,[["render",O]]);k.install=e=>{e.component(k.name||"VkfInputCollection",k)};export{k as V};
