import{p as S,V as F,c as P,u as D}from"./chunk-lmOyQrer.js";import{aM as I,d as C,aN as h,$,u as w,aO as A,aP as E,G as N,aQ as O,v as y,c as k,b as s,aR as M,aS as j,F as z,aT as b,M as R,f as i,o as v,a as x,w as f,Y as W,Z as G,g as H,j as K,i as Q}from"./chunk-Dr2pd04r.js";import{V as Y}from"./chunk-Z3iUL4cx.js";import{_ as Z}from"./chunk-BeHgPZOF.js";import{_ as q}from"./chunk-CdeRgiLc.js";import{e as T,g as J}from"./chunk-B-mQUuBe.js";const L={...S,columns:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},readonly:{type:Boolean,default:void 0},splicable:{type:Boolean,default:!0}},U={"update:modelValue":null},B={type:{type:String,default:"default"},label:String,className:String,labelClassName:String,property:String,prop:String,width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},renderHeader:Function,sortable:{type:[Boolean,String],default:!1},sortMethod:Function,sortBy:[String,Function,Array],resizable:{type:Boolean,default:!0},columnKey:String,align:String,headerAlign:String,showTooltipWhenOverflow:Boolean,showOverflowTooltip:Boolean,fixed:[Boolean,String],formatter:Function,selectable:Function,reserveSelection:Boolean,filterMethod:Function,filteredValue:Array,filters:Array,filterPlacement:String,filterMultiple:{type:Boolean,default:!0},index:[Number,Function],sortOrders:{type:Array,default:()=>["ascending","descending",null],validator:e=>e.every(n=>["ascending","descending",null].includes(n))}},X=$(B),ee={...B,source:{type:Array,default:()=>[]}};var te=C({name:"VkTableColumns",components:{ElTableColumn:h},props:ee,setup(e){const n=X(e);return()=>{const p=(c=e.source)=>c.reduce((u,a)=>{if(w(a.hidden))return u;let r={};A(a.slots)&&(r=a.slots),typeof a.slots=="function"&&(r.default=a.slots),a.children&&(r.default=()=>p(a.children));const l={key:a.prop,...n.value,...E(a,{excludes:["children","slots"]})};return Object.keys(l).forEach(d=>{(l[d]===void 0||l[d]===null||l[d]==="")&&Reflect.deleteProperty(l,d)}),u.push(N(h,l,r)),u},[]);return p(e.source)}}}),V=I(te,[["__file","/home/runner/work/vunk-plus/vunk-plus/packages/components/table-columns/src/index.vue"]]);V.install=e=>{e.component(V.name,V)};const ae=C({name:"VkfInputCollection",components:{ElTable:O,ElButton:y,VkTableColumns:V,VkfFormItem:F,VkfTemplateInstancesProvider:Z,VkfTemplatesDefault:Y},props:L,emits:U,setup(e,{emit:n}){const p=P(e),c=D(e),u=k(()=>{if(!e.prop||e.prop.length===0)return e.modelValue;const t={};return T(t,{k:e.prop,v:e.modelValue}),t}),a=k(()=>e.columns.map(t=>({...t,slots:o=>s(q,{source:[{prop:[e.prop??[],o.$index,t.prop].flat(),templateType:t.templateType,readonly:c.value,...t.templateProps,...t.createTemplateProps?.(o)}]},null)}))),m=k(()=>({label:"操作",align:"center",width:"120px",hidden:c.value||!e.splicable,slots:({$index:t})=>s(z,null,[s(y,{size:"small",icon:M,onClick:()=>r(t)},null),s(y,{size:"small",icon:j,onClick:()=>l(t)},null)])}));function r(t){const o=b(e.modelValue);o.splice(t+1,0,{}),n("update:modelValue",o)}function l(t){const o=b(e.modelValue);o.splice(t,1),n("update:modelValue",o)}return{addToFirst:()=>{n("update:modelValue",[{},...e.modelValue])},formItemBindProps:p,readonly:c,fullColumns:a,buttonsColumn:m,handleFormSetData:t=>{const o=b(u.value);T(o,t),n("update:modelValue",J(o,e.prop))},formData:u}}}),ne={key:0,class:"vkf-input-collection-options"};function oe(e,n,p,c,u,a){const m=i("VkfTemplatesDefault"),r=i("ElButton"),l=i("VkTableColumns"),d=i("ElTable"),_=i("VkfFormItem"),t=i("VkfTemplateInstancesProvider");return v(),x(t,null,{default:f(()=>[s(m,{data:e.formData,onSetData:e.handleFormSetData},null,8,["data","onSetData"]),s(_,W(G(e.formItemBindProps)),{default:f(()=>[!e.readonly&&e.splicable?(v(),H("div",ne,[s(r,{type:"primary",onClick:e.addToFirst},{default:f(()=>n[0]||(n[0]=[K(" 添加 ")])),_:1},8,["onClick"])])):Q("",!0),s(d,{data:e.modelValue,class:"vkf-input-collection-table"},{default:f(()=>[s(l,{source:[...e.fullColumns,e.buttonsColumn]},null,8,["source"])]),_:1},8,["data"])]),_:1},16)]),_:1})}const g=R(ae,[["render",oe]]);g.install=e=>{e.component(g.name||"VkfInputCollection",g)};export{g as V};
