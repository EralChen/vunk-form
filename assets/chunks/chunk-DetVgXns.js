import{a1 as R,br as A,bM as S,bQ as v,az as B,bR as W,bS as j}from"./chunk-Bn1Ae4Nb.js";import{j as $}from"./chunk-BfJcTM-c.js";const F=new Float64Array(2),T=new Float64Array(2),Y="0123456789bcdefghjkmnpqrstuvwxyz",k=64;function K(n,e,r,a){const t=[n.xmin,n.ymin,n.xmax,n.ymax],s=R.fromExtent(A.fromBounds(t,a)),c=$(s,a,S.WGS84,{densificationStep:e*k});if(!c)return null;const o=v(new B,c,!1,!1),i=o.coords.filter((g,m)=>!(m%2)),f=o.coords.filter((g,m)=>m%2),y=Math.min(...i),x=Math.min(...f),l=Math.max(...i),h=Math.max(...f),u=w(y,x,r,S.WGS84),b=w(l,h,r,S.WGS84);return u&&b?{bounds:t,geohashBounds:{xLL:u[0],yLL:u[1],xTR:b[0],yTR:b[1]},level:r}:null}function w(n,e,r,a){if(a.isWebMercator){const c=W(n/j.radius),o=c-360*Math.floor((c+180)/360),i=[0,0];return L(i,0,W(Math.PI/2-2*Math.atan(Math.exp(-e/j.radius))),o,r),i}const t=$({x:n,y:e},a,S.WGS84);if(!t)return null;const s=[0,0];return L(s,0,t.y,t.x,r),s}function q(n){return Y[n]}function z(n){return(n[0]+n[1])/2}function G(n,e,r){return n[0]=e,n[1]=r,n}function C(n,e){const r=z(n),a=e,t=!e;n[0]=t*n[0]+a*r,n[1]=t*r+a*n[1]}function M(n,e){const r=e>z(n);return C(n,r),r}function P(n,e){let r=-90,a=90,t=-180,s=180;for(let c=0;c<e;c++){const o=Math.ceil((c+1)/2),i=Math.floor((c+1)/2),f=1-c%2,y=30-(3*o+2*i),x=30-(2*o+3*i),l=3*f+2*(1-f),h=2*f+3*(1-f),u=3*f+7*(1-f)<<x,b=(7*f+3*(1-f)<<y&n.geohashX)>>y,g=(u&n.geohashY)>>x;for(let m=l-1;m>=0;m--){const p=(t+s)/2,d=b&1<<m?1:0;t=(1-d)*t+d*p,s=(1-d)*p+d*s}for(let m=h-1;m>=0;m--){const p=(r+a)/2,d=g&1<<m?1:0;r=(1-d)*r+d*p,a=(1-d)*p+d*a}}return[t,r,s,a]}function L(n,e,r,a,t){t%2&&(t+=1);let s=0,c=0,o=-90,i=90,f=-180,y=180;for(let x=0;x<t/2;x++){for(let l=0;l<5;l++){const h=(f+y)/2,u=a>h?1:0;s|=u<<29-(l+5*x),f=(1-u)*f+u*h,y=(1-u)*h+u*y}for(let l=0;l<5;l++){const h=(o+i)/2,u=r>h?1:0;c|=u<<29-(l+5*x),o=(1-u)*o+u*h,i=(1-u)*h+u*i}}n[2*e]=s,n[2*e+1]=c}function Q(n,e,r){let a="";const t=G(F,-90,90),s=G(T,-180,180);for(let c=0;c<r;c++){let o=0;c%2?(o|=M(t,n)<<4,o|=M(s,e)<<3,o|=M(t,n)<<2,o|=M(s,e)<<1,o|=M(t,n)<<0):(o|=M(s,e)<<4,o|=M(t,n)<<3,o|=M(s,e)<<2,o|=M(t,n)<<1,o|=M(s,e)<<0),a+=q(o)}return a}export{w as A,P as R,K as S,Q as z};
