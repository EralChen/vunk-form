import{p as v,V as B,c as F,u as P}from"./chunk-BZT5mSTd.js";import{V as I}from"./chunk-DSluCnma.js";import{e as D,g as $}from"./chunk-DyvYxXn8.js";import{d as E,aJ as g,H as c,c as i,b as o,aK as R,aL as S,F as w,aM as f,W as z,l as n,o as V,a as b,w as s,ar as h,P as A,Q as N,n as M,y as H}from"./chunk-Dw53j9Qa.js";import{V as J}from"./chunk-Bi1EyO-G.js";import{_ as K}from"./chunk-DrIIi3Cp.js";import{_ as L}from"./chunk-DVj1gyv_.js";import{_ as Q}from"./chunk-bcUd3NzG.js";const W={...v,columns:{type:Array,default:()=>[]},modelValue:{type:Array,default:()=>[]},readonly:{type:Boolean,default:void 0},splicable:{type:Boolean,default:!0},inheritTemplates:{type:Boolean,default:!1}},j={"update:modelValue":null},q=E({name:"VkfInputCollection",components:{ElTable:g,ElButton:c,VkTableColumns:I,VkfFormItem:B,VkfTemplateInstancesProvider:K,VkfTemplatesDefault:J,VkfRendererData:Q},props:W,emits:j,setup(e,{emit:l}){const _=F(e),r=P(e),m=i(()=>{if(!e.prop||e.prop.length===0)return e.modelValue;const a={};return D(a,{k:e.prop,v:e.modelValue}),a}),T=i(()=>e.columns.map(a=>({...a,slots:t=>o(L,{source:[{prop:[e.prop??[],t.$index,a.prop].flat(),templateType:a.templateType,readonly:r.value,...a.templateProps,...a.createTemplateProps?.(t)}]},null)}))),u=i(()=>({label:"操作",align:"center",width:"120px",hidden:r.value||!e.splicable,slots:({$index:a})=>o(w,null,[o(c,{size:"small",icon:R,onClick:()=>d(a)},null),o(c,{size:"small",icon:S,onClick:()=>p(a)},null)])}));function d(a){const t=f(e.modelValue);t.splice(a+1,0,{}),l("update:modelValue",t)}function p(a){const t=f(e.modelValue);t.splice(a,1),l("update:modelValue",t)}return{addToFirst:()=>{l("update:modelValue",[{},...e.modelValue])},formItemBindProps:_,readonly:r,fullColumns:T,buttonsColumn:u,handleFormSetData:a=>{const t=f(m.value);D(t,a),l("update:modelValue",$(t,e.prop))},formData:m}}}),G={key:0,class:"vkf-input-collection-options"};function O(e,l,_,r,m,T){const u=n("VkfTemplatesDefault"),d=n("ElButton"),p=n("VkTableColumns"),y=n("ElTable"),C=n("VkfFormItem"),a=n("VkfRendererData"),t=n("VkfTemplateInstancesProvider");return V(),b(t,{"inherit-templates":e.inheritTemplates},{default:s(()=>[e.inheritTemplates?h("",!0):(V(),b(u,{key:0})),o(a,{data:e.formData,onSetData:e.handleFormSetData},{default:s(()=>[o(C,A(N(e.formItemBindProps)),{default:s(()=>[!e.readonly&&e.splicable?(V(),M("div",G,[o(d,{type:"primary",onClick:e.addToFirst},{default:s(()=>l[0]||(l[0]=[H(" 添加 ")])),_:1},8,["onClick"])])):h("",!0),o(y,{data:e.modelValue,class:"vkf-input-collection-table"},{default:s(()=>[o(p,{source:[...e.fullColumns,e.buttonsColumn]},null,8,["source"])]),_:1},8,["data"])]),_:1},16)]),_:1},8,["data","onSetData"])]),_:1},8,["inherit-templates"])}const k=z(q,[["render",O]]);k.install=e=>{e.component(k.name||"VkfInputCollection",k)};export{k as V};
