import{fv as u,dd as c,V as m,dW as y,dT as f,ak as g,z as w,fD as v,$ as V,a2 as C}from"./chunk-Bn1Ae4Nb.js";import"./chunk-D6q83-eg.js";import"./chunk-lmOyQrer.js";import"./chunk-Dr2pd04r.js";import"./chunk-fEI7Cr-O.js";import"./chunk-Ch0SDxT-.js";import"./chunk-DBIPdCjN.js";const r=Symbol();let l=class extends u(c){constructor(){super(...arguments),this.layerViews=new m,this._debouncedUpdate=y(async()=>{const{layer:e,parent:{footprintLayerView:a}}=this;let i=[];if(a){const s=this._createQuery(),{features:d}=await a.queryFeatures(s);this.suspended||(i=d.map(n=>e.acquireLayer(n)))}this.removeHandles(r),this.addHandles(i,r)})}attach(){this.addAttachHandles([this._updatingHandles.addOnCollectionChange(()=>this.layerViews,()=>this._updateStageChildren(),{initial:!0}),f(()=>this.parent.footprintLayerView?.dataUpdating===!1,()=>this._updateLayers()),g(()=>[this.layer.maximumVisibleSublayers,this.suspended,this.parent.footprintLayerView?.filter],()=>this._updateLayers())])}detach(){this.container.removeAllChildren(),this.removeHandles(r)}update(e){}moveStart(){}viewChange(){}moveEnd(){}isUpdating(){return this.layerViews.some(e=>e.updating)}_updateStageChildren(){this.container.removeAllChildren(),this.layerViews.forEach((e,a)=>this.container.addChildAt(e.container,a))}_updateLayers(){this.suspended?this.removeHandles(r):this._updatingHandles.addPromise(this._debouncedUpdate().catch(e=>{w.getLogger(this).error(e)}))}_createQuery(){const{parent:{footprintLayerView:e},layer:{maximumVisibleSublayers:a,parent:{itemTypeField:i,itemSourceField:s,objectIdField:d,orderBy:n}}}=this,p=`${i} <> 'Scene Service'`,t=e.createQuery();t.returnGeometry=!1,t.num=a,t.outFields=[d,s],t.where=v(t.where,p);const o=n?.find(h=>h.field&&!h.valueExpression);return o?.field&&(t.orderByFields=[`${o.field} ${o.order==="descending"?"DESC":"ASC"}`]),t}};l=V([C("esri.views.2d.layers.CatalogDynamicGroupLayerView2D")],l);const x=l;export{x as default};
